---
title: "Project1"
author: "Sylvia Baeyens"
date: "9/20/2021"
output: github_document
always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```


```{r packages, echo= FALSE, include= FALSE}
#including necessary libraries
library(data.table)
library(dplyr)
library(tidyverse)
library(leaflet)
library(R.utils)
library(ggplot2)
library(stringr)
```

# 1a. Reading in Data Files
```{r data-read, cache= TRUE}
Data2004 = data.table::fread("ad_viz_plotval_data2004.csv")
Data2019 = data.table::fread("ad_viz_plotval_data2019.csv")
```

# 1b. Summarizing Data
```{r}
# for 2005 Data
dim(Data2004)
head(Data2004)
tail(Data2004)

# for 2020 Data
dim(Data2019)
head(Data2019)
tail(Data2019)
```

The 2004 data has 19233 rows & 20 columns. The 2019 data has 53086 rows & 20 columns. WRITE MORE HERE

# 2. Combine the two data sets & variable name clean-up
```{r}
#combining data sets
#got stuck on adding the Year variable after combination, so did it manually before
Data2004$Year = 2004
Data2019$Year = 2019
DataTotal = rbind(Data2004, Data2019)


DataTotal = DataTotal %>%
  rename(
     PM2_5 = "Daily Mean PM2.5 Concentration",
     lat = "SITE_LATITUDE",
     lon = "SITE_LONGITUDE",
     city = "Site Name"
  )
```

# 3. Creating Map in Leaflet
```{r}
#assigning color palette
temp.pal = colorNumeric(c('navyblue','goldenrod'), domain = DataTotal$Year)

leaflet(DataTotal) %>%
  addProviderTiles('CartoDB.Positron') %>%
  addCircles(
    lat = ~lat, lng=~lon, 
    label = ~paste0(round(Year,2), 'Year'), color = ~ temp.pal(Year),
    opacity=1, fillOpacity=1
    ) 
#adding legend & title
  #addLegend('bottomleft', pal=temp.pal, values=DataTotal$Year,
    #title='Site Location in CA', opacity=1)
```

# 4a. Check for Missing or Improbable Data
```{r}

DataTotal[,table(is.na(PM2_5))]
summary(DataTotal$PM2_5)
conc = DataTotal[order(PM2_5)]
head(conc)
tail(conc)

```
There are NO missing values for PM2.5. However, there are negative numbers, as shown by a min of -2.2, which are implausible. Most of the negative PM 2.5 concentrations were measured at the Tahoe City-Fairway Drive Station in 2019. PM 2.5 concentrations are considered unhealthy above 35.4 ug/m3. However, some quick research showed that a concentration of 251 (the maximum) is not unheard of, but very rare and dangerous. Most of the extremely high PM2.5 measurements occurred in Yosemite NP in 2004. 

# 4b. Correct for Improbably Data
```{r}
dim(DataTotal)
DataTotal <- DataTotal[PM2_5>=0]
summary(DataTotal$PM2_5)
dim(DataTotal)
```
There were 283 instances of negative PM2.5 concentration values, which have now been removed.


# 5. Explore the Main Question of Interest at State, County & City Level
```{r}

```

